import{aO as $,aM as N,aT as p,f4 as h,fL as j,fP as F,fQ as d,fR as S}from"./index-C1aGfQcb.js";import{p as v}from"./jsonUtils-BWWcP_yB.js";import{i as I,p as O,m as P,h as A,y as C}from"./styleUtils-CEgUrR2a.js";function E(t){return t=t||globalThis.location.hostname,L.some(e=>(t==null?void 0:t.match(e))!=null)}function w(t,e){return t?(e=e||globalThis.location.hostname)?e.match(U)!=null||e.match(D)!=null?t.replace("static.arcgis.com","staticdev.arcgis.com"):e.match(x)!=null||e.match(T)!=null?t.replace("static.arcgis.com","staticqa.arcgis.com"):t:t:null}const U=/^devext\.arcgis\.com$/,x=/^qaext\.arcgis\.com$/,D=/^[\w-]*\.mapsdevext\.arcgis\.com$/,T=/^[\w-]*\.mapsqa\.arcgis\.com$/,L=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,U,x,/^jsapps\.esri\.com$/,D,T];function Q(t,e,l,a){const o=t.name;return o==null?Promise.reject(new $("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):t.styleName==="Esri2DPointSymbolsStyle"?W(o,e,a):I(t,e,a).then(r=>q(r,o,e,l,C,a))}function _(t,e){return e.items.find(l=>l.name===t)}function q(t,e,l,a,o,r){var b,g;const s=(l==null?void 0:l.portal)!=null?l.portal:N.getDefault(),y={portal:s,url:p(t.baseUrl),origin:"portal-item"},i=_(e,t.data);if(!i){const u=`The symbol name '${e}' could not be found`;return Promise.reject(new $("symbolstyleutils:symbol-name-not-found",u,{symbolName:e}))}let m=h(o(i,a),y),c=((b=i.thumbnail)==null?void 0:b.href)??null;const f=(g=i.thumbnail)==null?void 0:g.imageData;E()&&(m=w(m)??"",c=w(c));const M={portal:s,url:p(j(m)),origin:"portal-item"};return O(m,r).then(u=>{const R=a==="cimRef"?P(u.data):u.data,n=v(R,M);if(n&&F(n)){if(c){const z=h(c,y);n.thumbnail=new d({url:z})}else f&&(n.thumbnail=new d({url:`data:image/png;base64,${f}`}));t.styleUrl?n.styleOrigin=new S({portal:l.portal,styleUrl:t.styleUrl,name:e}):t.styleName&&(n.styleOrigin=new S({portal:l.portal,styleName:t.styleName,name:e}))}return n})}function W(t,e,l){const a=A.replaceAll(/\{SymbolName\}/gi,t),o=e.portal!=null?e.portal:N.getDefault();return O(a,l).then(r=>{const s=P(r.data);return v(s,{portal:o,url:p(j(a)),origin:"portal-item"})})}const H=Object.freeze(Object.defineProperty({__proto__:null,fetchSymbolFromStyle:q,getStyleItemFromStyle:_,resolveWebStyleSymbol:Q},Symbol.toStringTag,{value:"Module"}));export{w as a,Q as g,q as h,_ as j,H as w};
