import{aT as i,aU as m,aV as o,aW as c,aX as w,aY as g,aZ as S,a_ as y}from"./index-C1aGfQcb.js";const v={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},f=Object.values(v),d=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${f.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),C=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${f.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),I=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function $(r){return d.test(r)}function p(r){if(r==null)return null;const e=i(r),t=(e==null?void 0:e.path.match(d))||(e==null?void 0:e.path.match(C));if(!t)return null;const[,s,n,l,a]=t,u=n.indexOf("/");return{title:h(u!==-1?n.slice(u+1):n),serverType:v[l.toLowerCase()],sublayer:a!=null&&a!==""?parseInt(a,10):null,url:{path:s}}}function b(r){const e=i(r).path.match(I);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function h(r){return(r=r.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+r.slice(1)}function j(r,e){const t=[];if(r){const s=p(r);s!=null&&s.title&&t.push(s.title)}if(e){const s=h(e);t.push(s)}if(t.length===2){if(t[0].toLowerCase().includes(t[1].toLowerCase()))return t[0];if(t[1].toLowerCase().includes(t[0].toLowerCase()))return t[1]}return t.join(" - ")}function x(r){let e=m(r,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")))}function U(r,e){return r&&o(c(r,e))}function W(r){let{url:e}=r;if(!e)return{url:e};e=c(e,r.logger);const t=i(e),s=p(t.path);let n;if(s!=null)s.sublayer!=null&&r.layer.layerId==null&&(n=s.sublayer),e=s.url.path;else if(r.nonStandardUrlAllowed){const l=b(t.path);l!=null&&(e=l.serviceUrl,n=l.sublayerId)}return{url:o(e),layerId:n}}function T(r,e,t,s,n){w(e,s,"url",n),s.url&&r.layerId!=null&&(s.url=g(s.url,t,r.layerId.toString()))}function V(r){if(!r)return!1;const e=r.toLowerCase(),t=e.includes("/services/"),s=e.includes("/mapserver/wmsserver"),n=e.includes("/imageserver/wmsserver"),l=e.includes("/wmsserver");return t&&(s||n||l)}function _(r){var s;if(!r)return!1;const e=new S(y(r)),t=(s=e.authority)==null?void 0:s.toLowerCase();return t==="server.arcgisonline.com"||t==="services.arcgisonline.com"}export{T as C,_ as I,W as S,V as b,p as d,x as g,b as h,h as m,$ as p,j as w,U as y};
